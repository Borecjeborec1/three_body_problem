!function () { "use strict"; e = document.querySelector(".debugOutput"); var e, t = { calculate: function (e, t, i) { for (var n = [e / 2, e / 2, e, 0], a = [e / 6, e / 3, e / 3, e / 6], r = [], o = [], s = t.length, l = 0; l < s; l++)r.push(t[l]), o.push(0); for (var u = 0; u < 4; u++) { var d = i(); for (l = 0; l < s; l++)t[l] = r[l] + n[u] * d[l], o[l] = o[l] + a[u] * d[l] } for (l = 0; l < s; l++)t[l] = r[l] + o[l] } }, i = function () { var e = { gravitationalConstant: 6.67408 * Math.pow(10, -11), averageDensity: 1410 }, i = { u: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] }, n = { bodies: 3 }; function a(e, t) { return Math.pow(3 / 4 * e / (Math.PI * t), 1 / 3) } function r(t, a) { for (var r = 0, o = 4 * t, s = 0; s < n.bodies; s++)if (t !== s) { var l = 4 * s, u = i.u[l + 0] - i.u[o + 0], d = i.u[l + 1] - i.u[o + 1], c = Math.sqrt(Math.pow(u, 2) + Math.pow(d, 2)), h = 1; !0 !== n.dimensionless && (h = e.gravitationalConstant), r += h * n.masses[s] * (i.u[l + a] - i.u[o + a]) / Math.pow(c, 3) } return r } function o() { for (var e = new Array(4 * n.bodies), t = 0; t < n.bodies; t++) { var a = 4 * t; e[a + 0] = i.u[a + 0 + 2], e[a + 1] = i.u[a + 0 + 3], e[a + 2] = r(t, 0), e[a + 3] = r(t, 1) } return e } return { resetStateToInitialConditions: function () { var e, t; for (e = 0; e < n.bodies; e++) { t = 4 * e; var a = n.positions[e]; i.u[t + 0] = a.r * Math.cos(a.theta), i.u[t + 1] = a.r * Math.sin(a.theta); var r = n.velocities[e]; i.u[t + 2] = r.r * Math.cos(r.theta), i.u[t + 3] = r.r * Math.sin(r.theta) } var o = function () { for (var e = { x: 0, y: 0 }, t = 0, a = 0; a < n.bodies; a++) { var r = 4 * a; e.x += n.masses[a] * i.u[r + 2], e.y += n.masses[a] * i.u[r + 3], t += n.masses[a] } return e.x /= t, e.y /= t, e }(), s = function () { for (var e = { x: 0, y: 0 }, t = 0, a = 0; a < n.bodies; a++) { var r = 4 * a; e.x += n.masses[a] * i.u[r + 0], e.y += n.masses[a] * i.u[r + 1], t += n.masses[a] } return e.x /= t, e.y /= t, e }(); for (e = 0; e < n.bodies; e++)t = 4 * e, i.u[t + 0] -= s.x, i.u[t + 1] -= s.y, i.u[t + 2] -= o.x, i.u[t + 3] -= o.y }, updatePosition: function (e) { t.calculate(e, i.u, o) }, calculateNewPosition: function () { for (var e = 0; e < n.bodies; e++) { var t = 4 * e; i.positions[e].x = i.u[t + 0], i.positions[e].y = i.u[t + 1] } }, initialConditions: n, state: i, calculateDiameters: function () { for (var t = [], i = 0; i < n.bodies; i++) { if (void 0 !== n.densities && n.densities.length >= n.bodies - 1) var r = n.densities[i]; else r = e.averageDensity; t.push(2 * a(n.masses[i], r)) } return t }, largestDistanceMeters: function () { for (var e = 0, t = 0; t < n.bodies; t++) { var i = n.positions[t]; e < i.r && (e = i.r) } return e }, changeInitialConditions: function (e) { n.dimensionless = e.dimensionless, n.masses = e.masses.slice(), n.positions = e.positions, n.velocities = e.velocities, n.timeScaleFactor = e.timeScaleFactor, n.massSlider = e.massSlider, n.timeScaleFactorSlider = e.timeScaleFactorSlider, n.densities = e.densities, n.paleOrbitalPaths = e.paleOrbitalPaths }, constants: e } }(), n = function () { var e = null, t = null, i = 600, n = 100, a = { orbitalPaths: ["#27e8A7", "#df4576", "#add7ff"], paleOrbitalPaths: ["#27e8A7", "#df4576", "#add7ff"] }, r = [{ x: null, y: null }, { x: null, y: null }, { x: null, y: null }], o = [{ x: null, y: null }, { x: null, y: null }, { x: null, y: null }], s = [], l = [10, 10, 10], u = 1, d = 1; function c(e, i, n) { if (null === i.x) return i.x = e.x, void (i.y = e.y); t.beginPath(), t.strokeStyle = n, t.moveTo(i.x, i.y), t.lineTo(e.x, e.y), t.stroke(), i.x = e.x, i.y = e.y } function h() { i = Math.min(window.innerHeight, window.innerWidth) - 100, document.querySelector(".container").style.height = i + "px", e.style.width = "100%", e.style.height = i + "px", e.width = e.offsetWidth, e.height = e.offsetHeight } return { fitToContainer: h, drawOrbitalLines: function (e) { for (var t = 0; t < r.length; t++) { var i = r[t], n = e ? a.paleOrbitalPaths : a.orbitalPaths; c(i, o[t], n[t]) } }, drawBodies: function () { for (var e = 0; e < r.length; e++) { var t = r[e]; i = t, n = l[e], a = s[e], o = void 0, u = void 0, o = i.x - n / 2 + 1e3, u = i.y - n / 2 + 1e3, a.style.transform = "translate(" + o + "px," + u + "px)" } var i, n, a, o, u }, updateObjectSizes: function (e) { for (var t = 0; t < e.length; t++)l[t] = e[t] / n, l[t] < 10 && (l[t] = 10), l[t] > 80 && (l[t] = 80), s[t].style.width = l[t] + "px" }, clearScene: function (i) { t.clearRect(0, 0, e.width, e.height), o = [{ x: null, y: null }, { x: null, y: null }, { x: null, y: null }], n = 2.3 * i / Math.min(e.offsetWidth, e.offsetHeight, window.innerHeight) }, calculateNewPositions: function (t) { for (var i = 0; i < t.length / 4; i++) { var a = 4 * i, o = t[a + 0], s = t[a + 1]; u = Math.floor(e.width / 2), d = Math.floor(e.height / 2), r[i].x = o / n + u, r[i].y = -s / n + d } }, init: function (i) { if (e = document.querySelector(".canvas"), window.requestAnimationFrame && e && e.getContext && (t = e.getContext("2d"))) { h(); var n = document.querySelector(".earth"), a = document.querySelector(".sun"), r = document.querySelector(".jupiter"); (s = []).push(a), s.push(n), s.push(r), i() } else document.getElementById("notSupportedMessage").style.display = "block" } } }(), a = function () { var e = Math.ceil(25); function t() { for (var a = i.initialConditions.timeScaleFactor / 60 / 250, r = 0; r < 250; r++)i.updatePosition(a), r % e == 0 && (n.calculateNewPositions(i.state.u), n.drawOrbitalLines(i.initialConditions.paleOrbitalPaths)); n.drawBodies(), window.requestAnimationFrame(t) } return { start: function () { n.init((function () { i.resetStateToInitialConditions(), n.clearScene(i.largestDistanceMeters()), n.updateObjectSizes(i.calculateDiameters()), window.addEventListener("resize", (function (e) { n.fitToContainer(), n.clearScene(i.largestDistanceMeters()), n.calculateNewPositions(i.state.u), n.drawOrbitalLines(i.initialConditions.paleOrbitalPaths), n.drawBodies() })), t() })) } } }(), r = function () { function e(e, t) { return (" " + e.className + " ").indexOf(" " + t + " ") > -1 } return { hasClass: e, removeClass: function (e, t) { e.className = e.className.replace(new RegExp("(?:^|\\s)" + t + "(?:\\s|$)"), " ") }, addClass: function (t, i) { e(t, i) || (t.className += " " + i) } } }(), o = function () { var e = { didChangeModel: null }, t = { x: .97000436, y: -.24308753 }, i = { x: -.93240737, y: -.86473146 }; function n(e) { var t; return t = 0 === e.x ? 0 : Math.atan2(e.y, e.x), { r: Math.sqrt(Math.pow(e.x, 2) + Math.pow(e.y, 2)), theta: t } } var a = { FigureEight: { dimensionless: !0, masses: [1, 1, 1], massSlider: { min: .1, max: 5, power: 3 }, timeScaleFactor: 1, timeScaleFactorSlider: { min: 0, max: 5e3, power: 5 }, positions: [n(t), n({ x: -t.x, y: -t.y }), n({ x: 0, y: 0 })], velocities: [n({ x: -i.x / 2, y: -i.y / 2 }), n({ x: -i.x / 2, y: -i.y / 2 }), n(i)] }, SunEarthJupiter: { masses: [1.98855 * Math.pow(10, 30), 5.972 * Math.pow(10, 24), 1.898 * Math.pow(10, 27)], densities: [.01, .01, .01], massSlider: { min: 3 * Math.pow(10, 10), max: 3 * Math.pow(10, 31), power: 3 }, timeScaleFactor: 31536e3, timeScaleFactorSlider: { min: 0, max: 432e9, power: 5 }, positions: [{ r: 0, theta: 0 }, { r: 1.496 * Math.pow(10, 11), theta: 0 }, { r: 7.78 * Math.pow(10, 11), theta: 0 }], velocities: [{ r: 0, theta: Math.PI / 2 }, { r: 30 * Math.pow(10, 3), theta: Math.PI / 2 }, { r: 13.1 * Math.pow(10, 3), theta: Math.PI / 2 }] }, LagrangePoint5: { masses: [1.98855 * Math.pow(10, 30), 5.972 * Math.pow(10, 24), 1.898 * Math.pow(10, 28)], densities: [.001, 1e-4, 1e-4], paleOrbitalPaths: !0, massSlider: { min: 3 * Math.pow(10, 10), max: 3 * Math.pow(10, 31), power: 5 }, timeScaleFactor: 864e5, timeScaleFactorSlider: { min: 0, max: 432e9, power: 5 }, positions: [{ r: 0, theta: 0 }, { r: 7.5 * Math.pow(10, 11), theta: -Math.PI / 3 - Math.PI / 10 }, { r: 7.78 * Math.pow(10, 11), theta: 0 }], velocities: [{ r: 0, theta: Math.PI / 2 }, { r: 13.3 * Math.pow(10, 3), theta: Math.PI / 6 - Math.PI / 10 }, { r: 13.1 * Math.pow(10, 3), theta: Math.PI / 2 }] }, Kepler16: { masses: [1.371502935 * Math.pow(10, 30), .20255 * 1.98855 * Math.pow(10, 30), .3333 * 1.898 * Math.pow(10, 27)], massSlider: { min: 3 * Math.pow(10, 10), max: 3 * Math.pow(10, 31), power: 5 }, timeScaleFactor: 3542400, timeScaleFactorSlider: { min: 0, max: 432e7, power: 5 }, positions: [{ r: .067969249788 * Math.pow(10, 11) / .89225, theta: 0 }, { r: .154706607 * 1.496 * Math.pow(10, 11) / .89225, theta: Math.PI }, { r: 1.0543808 * Math.pow(10, 11), theta: 0 }], velocities: [{ r: 13 * Math.pow(10, 3), theta: Math.PI / 2 }, { r: 44 * Math.pow(10, 3), theta: 3 * Math.PI / 2 }, { r: 33 * Math.pow(10, 3), theta: Math.PI / 2 }] }, Chaotic: { dimensionless: !0, masses: [1, 1, 1], massSlider: { min: .1, max: 10, power: 3 }, timeScaleFactor: 3.9335, timeScaleFactorSlider: { min: 0, max: 100, power: 3 }, positions: [{ r: 1, theta: 0 }, { r: 1, theta: 2 * Math.PI / 3 }, { r: 1, theta: 4 * Math.PI / 3 }], velocities: [{ r: .55, theta: Math.PI / 2 }, { r: .55, theta: 2 * Math.PI / 3 + Math.PI / 2 }, { r: .55, theta: 4 * Math.PI / 3 + Math.PI / 2 }] } }; function o(t) { if (r.hasClass(t, "preset")) { var i = t.getAttribute("data-name"), n = a[i]; null !== e.didChangeModel && e.didChangeModel(n); for (var s = document.querySelectorAll(".preset"), l = 0; l < s.length; l++) { var u = s[l]; r.removeClass(u, "button--isSelected") } r.addClass(t, "button--isSelected") } else o(t.parentElement) } function s(e) { e || (e = window.event), o(e.target) } return { init: function () { for (var e = document.querySelectorAll(".preset"), t = 0; t < e.length; t++) { e[t].onclick = s } return a.FigureEight }, content: e } }(), s = function () { function e(e, t) { return 0 === t ? 1 : -Math.pow(e, 1 / t) } function t(t, i) { return 0 === i ? 1 : Math.pow(1 - t, 1 / i) - e(t, i) } return { sliderInputValue: function (i, n, a) { if (0 === a) return 1; var r = t(i, a); 0 === r && (r = 1); var o = e(i, a); return ((n - i < 0 ? -1 : 1) * Math.pow(Math.abs(n - i), 1 / a) - o) / r }, sliderOutputValue: function (i, n, a) { if (0 === a) return 1; var r = t(i, a), o = e(i, a), s = Math.pow(r * n + o, a) + i; return s < 0 && (s = 0), s } } }(); (function () { var e, t, a = document.querySelector(".sliderLabel"), l = document.querySelector(".reload"), u = document.querySelector(".mass1Button"), d = document.querySelector(".mass2Button"), c = document.querySelector(".mass3Button"), h = document.querySelector(".speedButton"), m = document.querySelector(".slider"), f = "mass", p = 0; function v(e) { return (b(t) - e.min) / (e.max - e.min) } function w(e) { var t, r = y(); if (void 0 !== r.power) if (r.power % 2 == 1) { var o = v(r); e = s.sliderOutputValue(o, e, r.power) } else e = Math.pow(e, r.power); var l, u = r.min + (r.max - r.min) * e; l = u, u = Math.round(1e4 * l) / 1e4, "mass" === f ? (i.initialConditions.masses[p] = u, n.updateObjectSizes(i.calculateDiameters()), t = S(u)) : (i.initialConditions.timeScaleFactor = u, t = P(u)), a.innerText = t } function y() { return "mass" === f ? i.initialConditions.massSlider : i.initialConditions.timeScaleFactorSlider } function M(e) { return parseFloat(Math.round(1e4 * e) / 1e4).toFixed(4) } function S(e) { var t = M(e); return e > 1e4 && (t = e.toExponential(4)), t = "Hmotnost " + function (e) { switch (e) { case 0: return "Slunce"; case 1: return "Země"; default: return "Jupiteru" } }(p) + " : " + t, !0 !== i.initialConditions.dimensionless && (t += " kg"), t } function P(e) { var t = function (e) { var t = { unit: "sekund", value: e }; if (t.value < 60) return t; if (t.value /= 60, t.unit = "minut", t.value < 60) return t; if (t.value /= 60, t.unit = "hodin", t.value < 24) return t; if (t.value /= 24, t.unit = "dnů", t.value < 365) return t; if (t.value /= 365, t.unit = "let", t.value < 100) return t; return t.value /= 100, t.unit = "století", t }(e), i = M(t.value); return t.value > 1e4 && (i = t.value.toExponential(4)), i = "Rychlost simulace: " + i + " " + t.unit + " za sekundu" } function x() { return i.resetStateToInitialConditions(), n.clearScene(i.largestDistanceMeters()), n.updateObjectSizes(i.calculateDiameters()), !1 } function b(e) { return "mass" === f ? e.masses[p] : e.timeScaleFactor } function g() { r.removeClass(m, "sliderSun"), r.removeClass(m, "sliderEarth"), r.removeClass(m, "sliderJupiter"); var t, n = y(), o = b(i.initialConditions); if ("mass" === f) switch (t = S(i.initialConditions.masses[p]), p) { case 0: r.addClass(m, "sliderSun"); break; case 1: r.addClass(m, "sliderEarth"); break; default: r.addClass(m, "sliderJupiter") } else t = P(i.initialConditions.timeScaleFactor); a.innerText = t; var l = (o - n.min) / (n.max - n.min); if (void 0 !== n.power) if (n.power % 2 == 1) { var u = v(n); l = s.sliderInputValue(u, l, n.power) } else l = Math.pow(l, 1 / n.power); e.changePosition(l) } function C(e) { t = e, i.changeInitialConditions(t), x(), g() } function T() { return f = "mass", p = 0, g(), !1 } function B() { return f = "mass", p = 1, g(), !1 } function F() { return f = "mass", p = 2, g(), !1 } function I() { return f = "speed", p = 0, g(), !1 } return { init: function () { var n, a; t = o.init(), i.changeInitialConditions(t), o.content.didChangeModel = C, n = ".slider", a = { onSliderChange: null, previousSliderValue: -42, didRequestUpdateOnNextFrame: !1, init: function (e) { a.slider = document.querySelector(e), a.sliderHead = a.slider.querySelector(".SickSlider-head"); var t = !1; a.slider.addEventListener("mousedown", (function (e) { t = !0, a.updateHeadPositionOnTouch(e) })), a.slider.addEventListener("touchstart", (function (e) { t = !0, a.updateHeadPositionOnTouch(e) })), a.slider.onselectstart = function () { return !1 }, document.addEventListener("mouseup", (function () { t = !1 })), document.addEventListener("dragend", (function () { t = !1 })), document.addEventListener("touchend", (function (e) { t = !1 })), document.addEventListener("mousemove", (function (e) { t && a.updateHeadPositionOnTouch(e) })), document.addEventListener("touchmove", (function (e) { t && a.updateHeadPositionOnTouch(e) })), a.slider.addEventListener("touchmove", (function (e) { void 0 !== e.preventDefault && null !== e.preventDefault && e.preventDefault() })) }, sliderValueFromCursor: function (e) { var t = e.pageX; e.touches && e.touches.length > 0 && (t = e.touches[0].pageX); var i = (t -= a.slider.offsetLeft) - 16; i < 0 && (i = 0), i + a.sliderHead.offsetWidth > a.slider.offsetWidth && (i = a.slider.offsetWidth - a.sliderHead.offsetWidth); var n = a.slider.offsetWidth - a.sliderHead.offsetWidth, r = 1; return 0 !== n && (r = i / n), r }, changePosition: function (e) { var t = (a.slider.offsetWidth - a.sliderHead.offsetWidth) * e; a.sliderHead.style.left = t + "px" }, updateHeadPositionOnTouch: function (e) { var t = a.sliderValueFromCursor(e); Math.round(1e4 * a.previousSliderValue) !== Math.round(1e4 * t) && (a.previousSliderValue = t, a.didRequestUpdateOnNextFrame || (a.didRequestUpdateOnNextFrame = !0, window.requestAnimationFrame(a.updateOnFrame))) }, updateOnFrame: function () { a.changePosition(a.previousSliderValue), a.onSliderChange && a.onSliderChange(a.previousSliderValue), a.didRequestUpdateOnNextFrame = !1 } }, a.init(n), (e = a).onSliderChange = w, g(), l.onclick = x, u.onclick = T, d.onclick = B, c.onclick = F, h.onclick = I } } })().init(), a.start() }();
